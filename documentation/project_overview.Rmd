---
title: "Predictive value of traits for ecosystem processes/functions"
output: html_notebook
---

## Description of the project

Several recent papers have suggested that the predictive value of functional traits for ecosystem processes/functions (function used hereafter) is relatively low (e.g. van der Plas et al. 2020). The basis for this claim usually comes from examining the coefficient of determination (r2) when attempting to predict an ecosystem function using a community-level trait (e.g. community weighted mean or functional diversity) using some sort of linear regression framework. In several cases, the r2 value is considered "low" by the authors (often around 0.20 or 0.30, at least for some traits). However, a question that has not been asked is: How much variation in an ecosystem function can we expect a community-level trait to reasonably explain? 

Here, we aim to answer this question by showing that there are fundamental limits to the variation that a community-level trait can explain in community productivity, one of the most commonly studied ecosystem processes (van der Plas 2019). To do this, we use a model that derives plant productivity from growing season length, species' standing biomass, species growing phenology and species maximum relative growth rate (Garnier et al. 2004).

## Methods

Garnier et al. (2004, Ecology) proposed a causal model of aboveground net primary productivity (ANPP, g m-2 day-1). ANPP is defined as the net increase in aboveground biomass per unit area, per time of a community (Shipley et al. 2006, Ecology Letters). Their model writes ANPP as follows:

SANPP = sum(M0ij * (exp(RGRi * (tf - t0)i )-1 )) /dt

where M0ij is the standing biomass of species i in community j, RGRi is the maximum relative growth rate of species i, t0 and tf are the start and finish of species i's growing period and dt is the time interval over which ANPP was measured. This model is thus able to causally derive ANPP at the community level through species' standing biomass, average relative growth rates (RGRi), phenologies (tf and t0)i.

How does this model relate to the plant functional traits that are commonly measured in ecology? The expectation that community-level traits should predict ecosystem functioning is based on the assumption that commonly measured plant functional traits (e.g. SLA, leaf width etc.) are proxies for parameters like plant growth rates (Reich et al. 1992). In this model of ANPP, commonly measured plant functional traits would then be assumed to be correlated to species' RGRs which has been observed (Reich et al. 1992, Vile et al. 2006) or standing biomass (e.g. plant height).

However, just like any complex ecosystem function or process, ANPP does not only depend on species' RGRs. As outlined in the model above, ANPP depends on standing biomass and their phenology (tf and t0)i. These parameters may affect how well commonly measured plant functional traits can predict ecosystem functions. Moreover, the strength of the correlation between RGRs and traits like SLA will also affect predictions of ecosystem processes.

We use Garnier et al.'s (2004) model of ANPP to examine the following to examine the expected predictive values of community-level traits for ANPP given uncertainty in the relationship between community-level traits and RGR and variation in species' standing biomasses and phenology. We do this by simulating communities. These communities vary in:

+ 1. The standing biomass of different species in the community
+ 2. Their evenness in the relative abundance of different species
+ 3. The correlation between plant traits (e.g. SLA) and relative growth rate
+ 4. Whether species have similar or different phenologies
+ 5. Whether species with high RGR dominate communities

The graph below plots the r2 value of a linear regression between community-weighted SLA and SANPP (y-axis) as a function of the correlation between SLA and RGR (x-axis). All species had the same phenology and species with high trait values tended to dominate the community (i.e. high relative abundance) as is commonly assumed in models of community assembly (Shipley et al. 2006, Science). These are optimal conditions for explaining ecosystem functions using community-level trait values. 

From this (see below), it's clear that unless species' SLA is highly correlated to their RGR values (r > 0.5), the predictive value of SLA for SANPP is relatively low. Different colours represent different levels of species evenness in relative abundance.

```{r}



```
Below, we plot the same graph as previously but now species do not have the same phenology and species with high trait values do not necessarily dominate the community.

The predictive value of SLA for SANPP (r2, y-axis) increases with the correlation between SLA and RGR as previously. But, overall, there is much more variation and the average level of variation explained is considerably lower. Different colours represent different levels of species evenness in relative abundance.

This is probably a more realistic representation because it's highly unlikely that species have the same phenology and always dominate where their trait values are high.

```{r}



```

Therefore, this model suggests that we shouldn't really expect community-level traits like the community weighted mean of SLA to predict ecosystem functions like SANPP very well. Traits like SLA are imperfect proxies for things like RGR and other factors like varying phenology and dominance also affect the expected explanatory power. 

We chose to illustrate this point using a simple model using a single trait. But, for more complex traits and ecosystem functions, these results are still likely to hold.

## Additional notes

There are conditions that we can derive mathematically where the community weighted mean of RGR should be perfectly correlated with SANPP. However, with this model, these conditions are rather limited.

From doing simulations and trying to do the mathematics, I have derived the following conditions.

1. When there is only one species in each community, then the community weighted mean of RGR will be perfectly correlated with SANPP.

We can prove this mathematically as follows:


2. When multiple species are present in a community, the community weighted mean of RGR is calculated as the sum(pi x RGR). In contrast, the SANPP is calculated as as log( sum(pi x exp(RGR x (tf-t0)) ) )/dt. Therefore, rather than multiplying the proportion by the RGR, we multiply it by the exponential of the RGR scaled by the phenological period. Thus, the longer the phenological period is, the greater weight is put on the trait value (RGR) relative to the relative abundance (pi). The consequence of this is that the highest productivity individual species will often be the species with high RGR with a long phenological period rather than the species with the highest relative abundance (pi). In contrast, with a community weighted mean, the relative proportion has a much stronger influence so the community weighted mean generally matches the species' trait value.

This is difficult to prove mathematically but it explains several key observations from the simulations.

+ 1. When the phenological period is very limited (i.e. tf-to is 1 or 2), then the community weighted mean of RGR will be almost perfectly correlated with SANPP. This occurs because then the species that dominates production is very similar to the species that contributes most to the community weighted mean.

+ 2. When there is a perfect rank correlation between species' dominance and RGR, we also get the community weighted mean of RGR to be almost perfectly correlated with SANPP. This is because then species trait values are contributing in similar ways in the community weighted mean and the SANPP.


## Implications

From this modelling exercise, it seems clear that species can have a strong influence on ANPP in a patch in several different ways. They can have high standing biomass, high RGRs or long growing season. Therefore, when we find that community-weighted SLA does not explain much variation in productivity, it could be because there are differences in phenology or differences in standing biomass.

However, without relevant theory that links functional traits to fundamental parameters that determine the process rates in an ecosystem, it is difficult to explain such results. Right now, in the plant ecology literature, we are seeing a trait relationship with an ecosystem process as the end-goal rather than seeing the trait as a useful way to get at a given process in question.


## Other notes

RGR was estimated based on fresh mass but ANPP is measured in dry mass. If we want to get values that match Garnier et al. 2004, growth rates need to be
on the order of 0.005 and the phenology needs to only be 30 days this makes sense given that this is an RGR max and based on wet-weight in Vile et al. 2006.

We will generally use the ln-transformed productivity as the response variable because sometimes there are cases when the productivity varies on several orders of magnitude. Interestingly, this will often happen when the relative abundance distribution is very skewed. I think this happens because then some communities get very high ANPP if the phenology is long enough (i.e. exponential term in the equation).

















